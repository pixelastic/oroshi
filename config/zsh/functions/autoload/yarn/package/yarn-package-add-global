# Globally install a yarn package
#
# Yarn is managed through nvm, but by default:
# - Installs global code to ~/.config/yarn/global (`yarn global dir`)
# - Installs binary syminks to ~/.yarn/bin (`yarn global bin`)
#
# As we'll have one yarn installation per node version, we need to keep separate
# store of global packages as well.
#
# This can be achieved through yarn flags:
# --prefix defines where the main node installation is
# --global-folder defines where to store the global packages code
#
# Usage:
# $ yarn-package-add-global eslint_d   # Install into the current node version as selected by nvm
function yarn-package-add-global() {
	# Stop if no package given
	[[ $1 == "" ]] && return 1

	# Find the path the current node version
	local currentNodeVersion="$(nvm current)"
	local nodePrefixPath=$HOME/.nvm/versions/node/${currentNodeVersion}
	local yarnGlobalPath="${nodePrefixPath}/yarn/global"

	mkdir -p $yarnGlobalPath

	yarn global add \
		--prefix="${nodePrefixPath}" \
		--global-folder="${yarnGlobalPath}" \
		-- $@
}
