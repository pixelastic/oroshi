# Outputs the options shared by all search for a specific directory

# This is called by:
# - fzf-fs-directories-project-options
# - fzf-fs-directories-subdir-options
# with specific --source and --prompt values
#
# Usage:
# $ fzf-fs-directories-shared-options \
# --source         # Mandatory, function that displays the list of suggestions
# --prompt         # Mandatory, function that displays the prompt
function fzf-fs-directories-shared-options() {
	zmodload zsh/zutil
	zparseopts -E -D \
		-prompt:=flagPrompt \
		-source:=flagSource

	local fzfPromptPath=${flagPrompt[2]}
	local fzfSourcePath=${flagSource[2]}

	echo "--delimiter=   "
	echo "--with-nth=2"
	echo "--preview=fzf-fs-files-shared-preview {1}"

	# Prompt
	local prompt="$($fzfPromptPath)"
	echo "--prompt=${prompt}"

	# Keybindings
	# => [Right] goes down into the folder
	echo "--bind=right:execute-silent(fzf-fs-shared-cd {1})"
	echo "--bind=right:+reload(${fzfSourcePath})"
	echo "--bind=right:+transform-prompt(${fzfPromptPath})"
	echo "--bind=right:+first"
	# <= [Left] goes up into the parent
	echo "--bind=left:execute-silent(fzf-fs-shared-cd-up)"
	echo "--bind=left:+reload(${fzfSourcePath})"
	echo "--bind=left:+transform-prompt(${fzfPromptPath})"
	echo "--bind=left:+first"

	# Color the UI in directory color
	echo "--color=fg:$COLOR_ALIAS_DIRECTORY"
	echo "--color=fg+:$COLOR_ALIAS_DIRECTORY"
	echo "--color=query:${COLOR_ALIAS_DIRECTORY}:regular"
	echo "--color=separator:${COLOR_ALIAS_DIRECTORY}"
	echo "--color=info:${COLOR_ALIAS_DIRECTORY}"
	echo "--color=prompt:${COLOR_ALIAS_TEXT}:regular"
}
