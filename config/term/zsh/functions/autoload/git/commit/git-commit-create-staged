# Commit staged changes
# Usage:
# $ git-commit-create-staged                      # Commit staged changes, and ask for message
# $ git-commit-create-staged "Commit message"     # Commit staged changes with message
# $ git-commit-create-staged -n "Commit message"  # Can pass arguments to git commit
function git-commit-create-staged() {
  local args=($@)

  # Find the commit message as the first argument without a dash as prefix
  local commitMessage=""
  local commitMessageIndex=""
  for ((argIndex=1; argIndex <= ${#args}; argIndex++)); do
    local argValue=$args[$argIndex]
    [[ $argValue = -* ]] && continue
    commitMessage=$argValue
    args[$argIndex]=()
  done

  # If a commit message is passed, we add it to the args
  if [[ $commitMessage != "" ]]; then
    args+=("--message")
    args+=($commitMessage)
  fi

  # We always make it verbose
  args+=("--verbose")

  # Commit staged files
  git commit ${args}
}
