# Extract all text content from a PDF into a txt file
# Usage
# $ pdf2txt ./path/to/file.pdf       # Creates a large .txt file with all text
# content
# $ pdf2txt ./path/to/file.pdf 12    # Creates a dump of only page 12
function pdf2txt() {
  for inputFilepath in "$@"; do
    local inputFilepath=${inputFilepath:a}
    local dirpath=${inputFilepath:h}
    local filepathBasename=${inputFilepath:t:r}
    local outputFilepath="${dirpath}/${filepathBasename}.txt"

    # Known errors that we can ignore
    local knownErrorsPattern='Syntax Warning: Invalid Font Weight'

    pdftotext \
      "$inputFilepath" \
      - \
      2> >(\grep -v "${knownErrorsPattern}" >&2) \
      >"$outputFilepath"
  done
}
