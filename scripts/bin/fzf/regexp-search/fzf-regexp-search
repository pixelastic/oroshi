#!/usr/bin/env zsh
# Starts a dynamic regexp search in file
# Usage:
# $ fzf-regexp-search fzf-regexp-search-***-source /path/to/directory

local sourceBinary="$1"
local directory="$2"

# The options to pass to fzf
local fzfOptions="$(fzf-regexp-search-options $sourceBinary)"

# Actual fzf selection
local rawSelection="$(fzf ${(f)fzfOptions})"

# Parsing the selection to extract only relevant information
local selection="$(fzf-regexp-search-postprocess "$rawSelection" $directory)"

echo $selection
