#!/usr/bin/env zsh
# Watch for changes in files and run specific command when they change
# Usage:
#   $ watch-and-reload ./file1.txt ./file2.txt 'something && ls'
local commandToRun=$@[-1]
local filesToWatch=(${(@)@[1,-2]})

# If only one argument, the command to run is the file to watch
if [[ $# == 1 ]]; then
  commandToRun=$@[1]
  filesToWatch=$@[1]
fi

# -c: Clear the screen
# -s: Run command using the shell
# Note: If the command to run takes too long, the script will hand until it
# ended its execution.
ls $filesToWatch \
  | entr -a -c -s "$commandToRun"
