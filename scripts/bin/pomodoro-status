#!/usr/bin/env zsh
# Returns one of:
# - running:{remainingTime}       // Pomodoro is currently running
# - paused:{remainingTime}        // Pomodoro is manually paused
# - stopped                       // Pomodoro is manually stopped
# - finished                      // Pomodoro has finished

local PAUSED_DATA_FILE=/tmp/pomodoro-pause.txt
local rawStatus="$(pomodoro status -f "%!R")"

# Finished is when it returns ❗️
if [[ $rawStatus == "❗️" ]]; then
  echo "finished"
  exit 0
fi

# When nothing is returned, it means it has stopped.
# Paused is a special case of stopped
if [[ $rawStatus == "" ]]; then
  # Check if a paused file exists
  if [[ -r $PAUSED_DATA_FILE ]]; then
    local remainingTime="$(cat $PAUSED_DATA_FILE)"
    echo "paused:${remainingTime}"
    exit 0
  fi

  echo "stopped"
  exit 0
fi

# Otherwise, it will return the remaining time, in minutes
echo "running:${rawStatus}"
exit 0




