#!/usr/bin/env zsh
# python-lint: Lint a Python file
# Usage:
# $ python-lint  ./path/to/file.py       # For CLI
# $ python-lint --json ./path/to/file.py  # For Vim

zparseopts -E -D \
  -json=flagJson
isJson=${#flagJson}

# Input file
inputFile="${1:a}"
if [[ ! -f "$inputFile" ]]; then
  echo "Error: File '$inputFile' not found" >&2
  exit 1
fi

# Optional args
formatAsJson=""
if [[ $isJson -gt 0 ]]; then
  formatAsJson="--output-format json"
fi

ruff check \
  ${=formatAsJson} \
  "$inputFile"
