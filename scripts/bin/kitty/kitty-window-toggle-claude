#!/usr/bin/env zsh
# Toggle between current window and a dedicated Claude Code window
# Each tab has its own Claude window stored in a "Claude" parking tab

# Find or create the Claude parking tab
if ! kitty-tab-exists "claude"; then
  kitty-tab-create "claude"
fi
local parkingTabId=$(kitty-tab-id "claude")

# Find or create the Claude window in parking tab
local currentTabId=$(kitty-tab-id)
local windowName="claude-${currentTabId}"
if ! kitty-window-exists "$windowName"; then
  kitty-window-create "$windowName" --tab "$parkingTabId"
fi

local claudeWindowId=$(kitty-window-id "$windowName")

# 1. Focuser la fenêtre Claude et la mettre en plein écran
#    - kitty@ focus-window --match "id:${claudeWindowId}"
#    - kitty@ goto-layout stack
#
# 2. Détecter si on est dans une fenêtre Claude (pour le retour)
#    - Ajouter une user_var oroshi_claude_callingWindowId lors de la création
#    - Vérifier si la fenêtre courante a cette variable
#    - Si oui, récupérer callingWindowId et focuser cette fenêtre
#    - Cela permet le toggle : origine → Claude → origine → Claude
