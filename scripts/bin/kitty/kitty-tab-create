#!/usr/bin/env zsh
# Create a new Kitty tab with the given title
# Usage:
# $ kitty-tab-create "Tab Name"                    # Create new tab without focus
# $ kitty-tab-create "Tab Name" --focus            # Create and switch to new tab
# $ kitty-tab-create "Tab Name" --cwd /some/path   # Create in specific directory

zparseopts -E -D \
  -focus=flagFocus \
  -cwd:=flagCwd

local tabName="$1"
local cwd=${flagCwd[2]:-current}

if [[ "$tabName" == "" ]]; then
  echo "Usage: kitty-tab-create <tab-name> [--focus] [--cwd <path>]"
  return 2
fi

# By default, keep focus on current tab, unless --focus is passed
local focusFlag="--keep-focus"
[[ -n "$flagFocus" ]] && focusFlag=""

kitty@ launch \
  --type tab \
  --tab-title "$tabName" \
  --location=after \
  $focusFlag \
  --cwd "$cwd" \
  zsh \
  1>/dev/null
