#!/usr/bin/env zsh
# Remove fullscreen from a window
# Does nothing if already not in fullscreen
# Usage:
# $ kitty-window-fullscreen-off           # Remove fullscreen from current window
# $ kitty-window-fullscreen-off 12        # Remove fullscreen from Window #12

local windowId="$1"
if [[ "$windowId" == "" ]]; then
  windowId=$(kitty-window-id)
fi

local tabId=$(kitty-window-tab-id "$windowId")

# Stop if only one window in tab (no need to change layout)
local windowCount=$(kitty-tab-window-count "$tabId")
if [[ "$windowCount" == "1" ]]; then
  exit 0
fi

# Stop if already not fullscreen
if ! kitty-window-is-fullscreen "$windowId"; then
  exit 0
fi

kitty@ goto-layout --match "id:${tabId}" splits
