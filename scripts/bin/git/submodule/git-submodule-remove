#!/usr/bin/env zsh
# Remove a submodule from a repo
# Usage:
# $ git-submodule-remove ./path/to/submodule # Removes the submodule
# $ git-submodule-remove ./one ./two         # Removes multiple submodules

for submoduleName in $@; do
	local absolutePath="${submoduleName:a}"

	# Skip missing directories
	[[ ! -d $absolutePath ]] && continue
	# Skip non-submodules
	git-is-submodule $absolutePath || continue

	# Tell git to stop tracking the files
	git rm --quiet $absolutePath

	# Remove the submodule from the config
	git config \
		--file .git/config \
		--remove-section "submodule.${submoduleName}"

	# Delete the .git/modules cache
	rm -rf .git/modules/${submoduleName}

	echo "âœ” $submoduleName deleted"
done
