#!/usr/bin/env zsh
# Wrapper of eslint-zx to be used by ALE in vim
#
# Usage (as called by ALE):
# $ eslint-zx-ale -f json --stdin --stdin-filename /path/to/file < /path/to/file

local tmpFolder="/tmp/oroshi/eslint-zx"
mkdir -p $tmpFolder

# ALE passes the input as stdin. We'll save it in a temporary file
local input="$(cat -)"
local uuid="$(md5 ${input:a})"
local inputFile="${tmpFolder}/${uuid}.js"
echo $input >$inputFile

# We pass every other argument directly to eslint-zx (that will in turn pass
# them to eslint_d)
local args=($@)

eslint-zx $args $inputFile
